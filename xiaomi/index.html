<!DOCTYPE HTML>
<html>
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1,
  maximum-scale=1, minimum-scale=1, user-scalable=no" />
  <link rel="stylesheet" href="../assets/css/base.css"/>
  <link rel="stylesheet" href="../assets/iconfont/iconfont.css">
  <link rel="stylesheet" href="css/index.css">
  <title>xiaomi</title>
</head>
<body>
  
  <div id="topbar">
    <div id="topbar-wrap" class="true-wrap">
      <div id="topbar-wrap-left" class="fl no-space">
        <a href="javascript:;">小米商城</a>
        <a href="javascript:;">MIUI</a>
        <a href="javascript:;">IoT</a>
        <a href="javascript:;">云服务</a>
        <a href="javascript:;">金融</a>
        <a href="javascript:;">有品</a>
        <a href="javascript:;">小爱开放平台</a>
        <a href="javascript:;">企业团购</a>
        <a href="javascript:;">资质证照</a>
        <a href="javascript:;">协议规则</a>
        <a href="javascript:;">下载app</a>
        <a href="javascript:;" class="normal">Select Region</a>
      </div>
      <div id="topbar-wrap-right" class="fr no-space">
        <a href="javascript:;">登录</a>
        <a href="javascript:;">注册</a>
        <a href="javascript:;">消息通知</a>
        <a href="javascript:;"><i class="iconfont icon-icon-test2"></i>购物车</a>
      </div>
    </div>
  </div>
  
  <div id="navbar">
    <div id="navbar-wrap">
      <div id="navbar-wrap-1" class="fl">
        <a href="javascript:;">
          <img src="img/mi.PNG" alt="logo" style="width: 50px;height: 50px;">
        </a>
      </div>
      <div id="navbar-wrap-2" class="fl">
        <ul class="no-space">
          <li><a href="javascript:;">小米手机</a></li>
          <li><a href="javascript:;" class="normal">Redmi 红米</a></li>
          <li><a href="javascript:;">电视</a></li>
          <li><a href="javascript:;">笔记本</a></li>
          <li><a href="javascript:;">家电</a></li>
          <li><a href="javascript:;">路由器</a></li>
          <li><a href="javascript:;">智能硬件</a></li>
          <li><a href="javascript:;">服务</a></li>
          <li><a href="javascript:;">社区</a></li>
        </ul>
      </div>
      <div id="navbar-wrap-3" class="fr">
        <form action="javascript:;" class="no-space">
          <input id="search-input" type="text">
          <span class="iconfont icon-icon-test3"></span>
        </form>
      </div>
    </div>
  </div>
  
  <div id="carousel">
    <div id="carousel-wrap">
      <div id="carousel-wrap-leftbar">
        <ul>
          <li>
            <a href="javascript:;">手机 电话卡<i class="iconfont icon-icon-test13"></i></a>
          </li>
          <li>
            <a href="javascript:;">电视 盒子<i class="iconfont icon-icon-test13"></i></a>
          </li>
          <li>
            <a href="javascript:;">笔记本 平板<i class="iconfont icon-icon-test13"></i></a>
          </li>
          <li>
            <a href="javascript:;">家电 插线板<i class="iconfont icon-icon-test13"></i></a>
          </li>
          <li>
            <a href="javascript:;">出行 穿戴<i class="iconfont icon-icon-test13"></i></a>
          </li>
          <li>
            <a href="javascript:;">智能 路由器<i class="iconfont icon-icon-test13"></i></a>
          </li>
          <li>
            <a href="javascript:;">电源 配件<i class="iconfont icon-icon-test13"></i></a>
          </li>
          <li>
            <a href="javascript:;">健康 儿童<i class="iconfont icon-icon-test13"></i></a>
          </li>
          <li>
            <a href="javascript:;">耳机 音箱<i class="iconfont icon-icon-test13"></i></a>
          </li>
          <li>
            <a href="javascript:;">生活 箱包<i class="iconfont icon-icon-test13"></i></a>
          </li>
        </ul>
      </div>
      
      <div id="tab">
        <div class="tab-item" style="background-color: #555"></div>
        <div class="tab-item" style="background-color: #666"></div>
        <div class="tab-item" style="background-color: #777"></div>
        <div class="tab-item" style="background-color: #888"></div>
        <div class="tab-item" style="background-color: #999"></div>
        <div class="tab-item" style="background-color: #aaa"></div>
        <div class="tab-item" style="background-color: #bbb"></div>
        <div class="tab-item" style="background-color: #ccc"></div>
        <div class="tab-item" style="background-color: #ddd"></div>
        <div class="tab-item" style="background-color: #eee"></div>
      </div>
      
      <div id="carousel-wrap-item">
        <a href="javascript:;"><div style="background-color: #FF7878;"></div></a>
        <a href="javascript:;"><div style="background-color: #B4FFB4;"></div></a>
        <a href="javascript:;"><div style="background-color: #A0B4FF;"></div></a>
        <a href="javascript:;"><div style="background-color: #FFFFB4;"></div></a>
        <a href="javascript:;"><div style="background-color: #B4FFFF;"></div></a>
      </div>
      
      <div id="toggle-btn">
        <span id="toggle-btn-left" class="iconfont icon-icon-test11"></span>
        <span id="toggle-btn-right" class="iconfont icon-icon-test13"></span>
      </div>
      
      <div id="spot" class="no-space">
        <span class="dot selected"></span>
        <span class="dot"></span>
        <span class="dot"></span>
        <span class="dot"></span>
        <span class="dot"></span>
      </div>
      
    </div><!-- carousel-wrap -->
  </div>
  
  <div id="item">
    <div id="item-wrap">
      
      <div id="phone" class="content">
        <div class="true-wrap content-header">
          <div class="fl">
            <h2>手机</h2>
          </div>
          <div class="fr">
            <a class="link" href="javascript:;">查看全部<i class="iconfont icon-icon-test15"></i></a>
          </div>
        </div>
        <div class="true-wrap content-body">
          <div class="fl">
            <div ></div>
          </div>
          <div class="fr">
            <div class="right-wrap true-wrap">
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-off"><p>减200元</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div id="homeutil" class="content">
        <div class="true-wrap content-header">
          <div class="fl">
            <h2>家电</h2>
          </div>
          <div class="fr">
            <a class="link" href="javascript:;">查看全部<i class="iconfont icon-icon-test15"></i></a>
          </div>
        </div>
        <div class="true-wrap content-body">
          <div class="fl">
            <div ></div>
          </div>
          <div class="fr">
            <div class="right-wrap true-wrap">
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
              <div class="item-list">
                <div class="tip tip-new"><p>新品</p></div>
                <div class="img">
                  <a href="javascript:;">
                    <img src="img/shouji.jpg" alt="img">
                    <h3>小米9 6GB+128GB</h3>
                  </a>
                </div>
                <p class="desc">骁龙855，索尼4800万超广角微距三摄</p>
                <p class="price">2999元</p>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      
    </div>
  </div>
  
  <script>
    (function(global){
      //变量下划线，函数驼峰，类匈牙利
      var lazy = {
        
        toggleClass: function(elem, cname){
          //toggle elem's className
          var arr = elem.className.split(' ');
          for(var i = 0; i < arr.length; i++){
            if (arr[i] === cname) {
              arr.splice(i,1);
              elem.className = arr.join(' ');
              return true;
            }
          }
          arr.push(cname);
          elem.className = arr.join(' ');
          return false;
        }
        //-------------------------------------------------------
        ,
        //-------------------------------------------------------
        tab: function(tab_obj){
          // {
          //   *switch: String,      tab开关
          //   *tab: String,         tab页
          //   event_open: String,  开启事件
          //   event_close: String  关闭事件
          // }
          try{
            var switch_string = tab_obj.switch;
            var tab_switch = document.querySelectorAll(switch_string);
            var tab_string = tab_obj.tab;
            var tab_col = document.querySelectorAll(tab_string);
            if(!tab_switch[0]) throw 'switch is undefined or wrong';
            if(!tab_col[0]) throw 'tab is undefined or wrong';
          }
          catch(err){
            console.log(err);
          }
          var event_open = tab_obj.event_open || 'mouseenter';
          var event_close = tab_obj.event_close || 'mouseleave';
          var indexOf = Array.prototype.indexOf;
          var toggleClass = lazy.toggleClass;
          
          for(var i = 0; i < tab_switch.length; i++){
            tab_switch[i].addEventListener('mouseenter', openTab);
            tab_switch[i].addEventListener('mouseleave', closeTab);
          }
          for(i = 0; i < tab_col.length; i++){
            tab_col[i].addEventListener('mouseenter', openTab);
            tab_col[i].addEventListener('mouseleave', closeTab);
          }
          
          function openTab(){
            //
            var index = indexOf.call(this.parentElement.children, this);
            toggleClass(tab_col[index], 'open-tab');
          }
          
          function closeTab(){
            var index = indexOf.call(this.parentElement.children, this);
            toggleClass(tab_col[index], 'open-tab');
          }
          
        }
        //------------------------------------------------
        ,
        //------------------------------------------------
        carousel: function(obj){
          /*
          {
            *wrap:      string  所有carousel相关元素的父元素
            *left_btn:  string  左按钮
            *right_btn: string  右按钮
            *dot:       string  小圆点集合（父元素只有该类子元素）
            *item：     string  滚动内容的集合（父元素只有该类子元素）
            anim:       string  [scroll|fade]
            speed:      int     动画时长，越短越快，默认500ms
            interval:   int     动画间隔时长，默认3000ms
          }
          */
          try{
            var carousel_wrap = document.querySelector(obj.wrap);
            var left_switch = document.querySelector(obj.left_btn);
            var right_switch = document.querySelector(obj.right_btn);
            var dot_list = document.querySelectorAll(obj.dot);
            var img_list = document.querySelectorAll(obj.item);
            if(!carousel_wrap)  throw 'wrap is undefined or error';
            if(!left_switch)  throw 'left_btn is undefined or error';
            if(!right_switch)  throw 'right_btn is undefined or error';
            if(!dot_list[0])  throw 'dot is undefined or error';
            if(!img_list[0])  throw 'item is undefined or error';
          }
          catch(err){
            console.log(err);
          }
          var index_now = 0;
          var img_count = img_list.length;
          var width = img_list[0].offsetWidth;
          var anim = obj.anim || 'scroll';
          var speed = obj.speed || 500;
          var scroll_interval = obj.interval || 3000;
          var indexOf = Array.prototype.indexOf;
          var toggleClass = lazy.toggleClass;
          
          if(anim === 'fade'){
            img_list.forEach(function(item, index){
              if(index === index_now){
                item.style.opacity = 1;
              }else{
                item.style.opacity = 0;
              }
            })
          }
          
          left_switch.addEventListener('click', leftOne);
          right_switch.addEventListener('click', rightOne);
          dot_list.forEach(function(item){
            item.addEventListener('click', which);
          });
          
          //自动滚动
          var t_handler = setInterval(rightOne, scroll_interval);
          carousel_wrap.addEventListener('mouseenter', function(){
            clearInterval(t_handler);
          });
          carousel_wrap.addEventListener('mouseleave', function(){
            t_handler = setInterval(rightOne, scroll_interval);
          });
          
          
          function which(e){
            var el = e.currentTarget;
            var index_new = indexOf.call(el.parentElement.children, el);
            if(index_new === index_now){
              return false;
            }else if(anim === 'scroll'){
              scroll(index_now, index_new);
            }else if(anim === 'fade'){
              fade(index_now, index_new);
            }
          }
          
          function leftOne(){
            if(index_now === 0){
              if(anim === 'scroll'){scroll(0, img_count-1);}
              else if(anim === 'fade'){fade(0, img_count-1);}
            }else{
              if(anim === 'scroll'){scroll(index_now, index_now-1);}
              else if(anim === 'fade'){fade(index_now, index_now-1);}
            }
          }
          
          function rightOne(){
            if(index_now === img_count-1){
              if(anim === 'scroll'){scroll(index_now, 0);}
              else if(anim === 'fade'){fade(index_now, 0);}
            }else{
              if(anim === 'scroll'){scroll(index_now, index_now+1);}
              else if(anim === 'fade'){fade(index_now, index_now+1);}
            }
          }
          
          function scroll(i_now, i_new){
            //动画时解除事件绑定
            right_switch.removeEventListener('click', rightOne);
            left_switch.removeEventListener('click', leftOne);
            dot_list.forEach(function(item){
              item.removeEventListener('click', which);
            });
            var space = width/(speed/10);
            if(i_now === img_count-1 && i_new === 0){
              var sign = 1;
            }else if(i_now === 0 && i_new === img_count-1){
              var sign = -1;
            }else if(i_now < i_new){
              var sign = 1;
            }else{
              sign = -1;
            }
            var style_now = img_list[i_now].style;
            var style_new = img_list[i_new].style;
            style_now.left = 0;
            style_new.left = sign*width + 'px';
            style_new.zIndex = 1;
            var th = setInterval(function(){
              var now_left = parseInt(style_now.left);
              var new_left = parseInt(style_new.left);
              style_now.left = (now_left-=space*sign) + 'px';
              style_new.left = (new_left-=space*sign) + 'px';
              if(new_left*sign <= 0){
                style_new.left = 0;
                style_now.left = 0;
                style_now.zIndex = 0;
                toggleClass(dot_list[i_now], 'selected');
                toggleClass(dot_list[i_new], 'selected');
                index_now = i_new;
                //结束后重新绑定
                left_switch.addEventListener('click', leftOne);
                right_switch.addEventListener('click', rightOne);
                dot_list.forEach(function(item){
                  item.addEventListener('click', which);
                });
                clearInterval(th);
              }
            }, 10)
            return false;
          }
          
          function fade(i_now, i_new){
            right_switch.removeEventListener('click', rightOne);
            left_switch.removeEventListener('click', leftOne);
            dot_list.forEach(function(item){
              item.removeEventListener('click', which);
            });
            var o_now = 1;
            var o_new = 0;
            var style_now = img_list[i_now].style;
            var style_new = img_list[i_new].style;
            var space = 1/(speed/10);
            var th = setInterval(function(){
              style_now.opacity = (o_now-=space);
              style_new.opacity = (o_new+=space);
              if(o_new >= 1){
                style_new.opacity = 1;
                style_now.opacity = 0;
                toggleClass(dot_list[i_now], 'selected');
                toggleClass(dot_list[i_new], 'selected');
                index_now = i_new;
                left_switch.addEventListener('click', leftOne);
                right_switch.addEventListener('click', rightOne);
                dot_list.forEach(function(item){
                  item.addEventListener('click', which);
                });
                clearInterval(th);
              }
            }, 10);
          }
        }
        
      }//lazy
      
      global.lazy = lazy;
    })(this);
  </script>
  <script>
    window.onload = function(){
      lazy.tab({
        switch: '#carousel-wrap-leftbar li',
        tab: '#tab .tab-item'
      });
      lazy.carousel({
        wrap: '#carousel-wrap',
        item: '#carousel-wrap-item a',
        left_btn: '#toggle-btn-left',
        right_btn: '#toggle-btn-right',
        dot: '#spot .dot',
        speed: 500,
        interval : 3000,
        anim: 'fade'
      })
    };
  </script>
</body>
</html>